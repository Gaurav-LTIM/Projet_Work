<!-- Use stable and unique IDs!-->
<core:FragmentDefinition  xmlns="sap.m" xmlns:mvc="sap.ui.core.mvc"  xmlns:core="sap.ui.core" xmlns:ui="sap.ui.table"
     xmlns:unified="sap.ui.unified" xmlns:layout="sap.ui.layout" xmlns:form="sap.ui.layout.form" controllerName ="com.sap.prupload.controller.DisplayPR">

   <Dialog
      title="PR Mass Upload"  id ="ExcelUpload" contentWidth="1400px" contentHeight ="1000px" resizable="true" afterClose="onClose">
      <content>
        <VBox  justifyContent="Center" alignItems="Center" class="sapUiSmallMarginTopBottom">
         <HBox>
                <unified:FileUploader id ="fileUpload" change="onUpload" width="100%"/>
                
        </HBox>
    <HBox  class="sapUiSmallMarginTop">
                 	<ProgressIndicator id ="idProg" width="12rem" displayValue="Validating 0%..." displayOnly="true"
				showValue="true" visible="false" height="5rem" state="None"
				/>
                </HBox>
               <VBox>
                  	<ProgressIndicator id ="idPR"
				width="12rem" displayValue="Creating PR 0%..." displayOnly="true"
				showValue="true" visible="false" height="5rem" state="None"
				/> </VBox>
     
          </VBox>
         <VBox>
         <HBox >
         <ui:Table id="excelTable" visible="true"  rows = "{excelData>/}"  selectionMode="None" >
         	<ui:extension>
					<OverflowToolbar style="Clear">
					<Title text="Records ({AppModel>/countRecord})" level="H2"/>
					</OverflowToolbar>
				</ui:extension>      
		 <ui:columns>
                          	<ui:Column width="11rem">
						<Label text="PR" />
						<ui:template>
							<Text text="{excelData>PREQ_NO}" wrapping="false" />
						</ui:template>

					</ui:Column>

                    <ui:Column width="11rem">
						<Label text="Item" />
						<ui:template>
							<Text text="{excelData>PRITEM_NO}" wrapping="false" />
						</ui:template>

					</ui:Column>

                    <ui:Column width="11rem">
						<Label text="Request Date" />
						<ui:template>
							<Text text="{excelData>PREQ_DATE}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Pur.Group" />
						<ui:template>
							<Text text="{excelData>PUR_GROUP}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Material" />
						<ui:template>
							<Text text="{excelData>MATERIAL}" wrapping="false" />
						</ui:template>
					</ui:Column>
					

					<ui:Column width="11rem">
						<Label text="Status" />
						<ui:template>
                            <core:Icon  src="sap-icon://circle-task-2" class="size5" color="{path:'excelData>STATUS',formatter: '.formatter.formatIconColor'}"></core:Icon>
						</ui:template>
					</ui:Column>

                    <ui:Column width="18rem">
						<Label text="Error Message" />
						<ui:template>
                            <!-- <core:Icon src="sap-icon://message-popup" color="blue" press="handlePopoverPress"/> -->
						<Text text="{excelData>ERROR_MSG}" wrapping="false" />
						</ui:template>
					</ui:Column>
					
                    <ui:Column width="11rem">
						<Label text="Quantity" />
						<ui:template>
							<Text text="{excelData>QUANTITY}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Unit" />
						<ui:template>
							<Text text="{excelData>UNIT}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Delivery date" />
						<ui:template>
							<Text text="{excelData>DELIV_DATE}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Plant" />
						<ui:template>
							<Text text="{excelData>PLANT}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Stor.Loc." />
						<ui:template>
							<Text text="{excelData>STORE_LOC}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Supplier" />
						<ui:template>
							<Text text="{excelData>FIXED_VEND}" wrapping="false" />
						</ui:template>

					</ui:Column>
					
                    <!-- <ui:Column width="11rem">
						<Label text="Pur Doc" />
						<ui:template>
							<Text text="{excelData>PurchasingDocument}" wrapping="false" />
						</ui:template>

					</ui:Column> -->
					  <!-- <ui:Column width="11rem">
						<Label text="Open Quantity" />
						<ui:template>
							<Text text="" wrapping="false" />
						</ui:template>

					</ui:Column> -->
					<!-- <ui:Column width="11rem">
						<Label text="BaseUnit" />
						<ui:template>
							<Text text="{excelData>BaseUnit}" wrapping="false" />
						</ui:template>

					</ui:Column> -->
					<!-- <ui:Column width="11rem">
						<Label text="Net Price" />
						<ui:template>
							<Text text="{excelData>ItemNetAmount}" wrapping="false" />
						</ui:template>

					</ui:Column>

					<ui:Column width="11rem">
						<Label text="Currency" />
						<ui:template>
							<Text text="{excelData>PurReqnItemCurrency}" wrapping="false" />
						</ui:template>

					</ui:Column> -->

					<!-- <ui:Column width="11rem">
						<Label text="Purchasing InfoRecord" />
						<ui:template>
							<Text text="{excelData>PurchasingInfoRecord}" wrapping="false" />
						</ui:template>

					</ui:Column> -->


                    <!-- <ui:Column width="11rem">
						<Label text="Deletion Indicator" />
						<ui:template>
							<Text text="{excelData>IsDeleted}" wrapping="false" />
						</ui:template>

					</ui:Column>
                     <ui:Column width="11rem">
						<Label text="Close Indicator" />
						<ui:template>
							<Text text="{excelData>IsClosed}" wrapping="false" />
						</ui:template>

					</ui:Column> -->
                       

                    

                    
                    
                    </ui:columns>
             </ui:Table>

			 <ui:Table id="poTbl" visible="false"  rows = "{podata>/}"  selectionMode="Multi" >
         	<ui:extension>
					<OverflowToolbar style="Clear">
					<Title text="Created Purchase Requisitions ({AppModel>/countRecord})" level="H2"/>
					</OverflowToolbar>
				</ui:extension>
		 <ui:columns>
                          	<ui:Column width="11rem">
						<Label text="PR" />
						<ui:template>
							<Text text="{podata>PurchaseRequisition}" wrapping="false" />
						</ui:template>

					</ui:Column>

                    <ui:Column width="11rem">
						<Label text="Item" />
						<ui:template>
							<Text text="{podata>PurchaseRequisitionItem}" wrapping="false" />
						</ui:template>

					</ui:Column>

                    <ui:Column width="11rem">
						<Label text="Request Date" />
						<ui:template>
							<Text text="{podata>PurReqCreationDate}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Pur.Group" />
						<ui:template>
							<Text text="{podata>PurchasingGroup}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Material" />
						<ui:template>
							<Text text="{podata>Material}" wrapping="false" />
						</ui:template>
					</ui:Column>
						 <ui:Column width="11rem">
						<Label text="MaterialDesc" />
						<ui:template>
							<Text text="{podata>ProductName}" wrapping="false" />
						</ui:template>

					</ui:Column>

					<ui:Column width="11rem" id="idColStatus" visible="false">
						<Label text="Status" />
						<ui:template>
                            <core:Icon  src="sap-icon://circle-task-2" class="size5" color="{path:'podata>ProcessingStatus',formatter: '.formatter.formatIconColor'}"></core:Icon>
						</ui:template>
					</ui:Column>

                    <ui:Column width="18rem" id="idErrorMsg"  visible="false">
						<Label text="Error Message" />
						<ui:template>
                            <!-- <core:Icon src="sap-icon://message-popup" color="blue" press="handlePOPopoverPress"/> -->
					<Text text="{podata>ERROR_MSG}" wrapping="false" />
						</ui:template>
					</ui:Column>
					
                    <ui:Column width="11rem">
						<Label text="Quantity" />
						<ui:template>
							<Text text="{podata>RequestedQuantity}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="BaseUnit" />
						<ui:template>
							<Text text="{podata>BaseUnit}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Delivery date" />
						<ui:template>
							<Text text="{podata>DeliveryDate}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Plant" />
						<ui:template>
							<Text text="{podata>Plant}" wrapping="false" />
						</ui:template>

					</ui:Column>
					 <ui:Column width="11rem">
						<Label text="Plant Desc" />
						<ui:template>
							<Text text="{podata>PlantName}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Stor.Loc." />
						<ui:template>
							<Text text="{podata>StorageLocation}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Supplier" />
						<ui:template>
							<Text text="{podata>FixedSupplier}" wrapping="false" />
						</ui:template>

					</ui:Column>
					 <ui:Column width="11rem">
						<Label text="SupplierDesc" />
						<ui:template>
							<Text text="{podata>SupplierName}" wrapping="false" />
						</ui:template>

					</ui:Column>
                    <ui:Column width="11rem">
						<Label text="Purchase Order" />
						<ui:template>
							<Text text="{podata>PurchasingDocument}" wrapping="false" />
						</ui:template>

					</ui:Column>
					<ui:Column width="11rem">
						<Label text="Purchasing Organisation" />
						<ui:template>
							<Text text="{podata>PurchasingOrganization}" wrapping="false" />
						</ui:template>

					</ui:Column>
					<ui:Column width="11rem">
						<Label text="Net Price" />
						<ui:template>
							<Text text="{podata>PurchaseRequisitionPrice}" wrapping="false" />
						</ui:template>

					</ui:Column>
					<ui:Column width="11rem">
						<Label text="Currency" />
						<ui:template>
							<Text text="{podata>PurReqnItemCurrency}" wrapping="false" />
						</ui:template>

					</ui:Column>
					<ui:Column width="11rem">
						<Label text="Purchasing InfoRecord" />
						<ui:template>
							<Text text="{podata>PurchasingInfoRecord}" wrapping="false" />
						</ui:template>
					</ui:Column>                 
                    </ui:columns>
             </ui:Table>
                </HBox>
            </VBox>                
            </content>
         <footer>
            <Toolbar>
                
                <Button  text="Excel Format Download" icon="sap-icon://excel-attachment" press="onDownloadExcel"/>
                <ToolbarSpacer/>
                <Button text="Create PR" press="onCreatePR" enabled="false" type="Accept" id="createPR"/>
                <Button text ="Convert PR to PO" id ="idPo" press ="onPoValidation" enabled="false"></Button>
                <Button text ="Cancel" press = "onCancel"/>
            </Toolbar>
        </footer>  
            </Dialog>
</core:FragmentDefinition>
